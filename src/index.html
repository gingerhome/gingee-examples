<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>GingerJS Test Runner</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
    <style>
        body {
            background-color: #f8f9fa;
        }

        #test-list-container {
            position: sticky;
            top: 1rem;
            /* Add some space from the top */
            height: calc(100vh - 2rem);
            /* Full viewport height minus top/bottom margin */
            display: flex;
            flex-direction: column;
        }

        #test-list {
            overflow-y: auto;
        }

        #test-list-container {
            position: sticky;
            top: 1rem;
            /* Add some space from the top */
            height: calc(100vh - 3rem);
            /* Full viewport height minus top/bottom margin */
            display: flex;
            flex-direction: column;
        }

        #source-code-view pre[class*="language-"] {
            background-color: #e9ecef;
            padding: 1rem;
            border-radius: 5px;
            max-height: 250px;
            overflow-y: auto;
            border: 1px solid #dee2e6;
            margin-top: 0.5rem;
            /* Overriding Prism's default margin */
        }

        #results-area pre,
        #source-code-view pre {
            background-color: #e9ecef;
            padding: 1rem;
            border-radius: 5px;
            max-height: 500px;
            overflow-y: auto;
        }

        #results-area iframe {
            width: 100%;
            height: 500px;
            border: 1px solid #dee2e6;
        }

        #results-area img {
            max-width: 100%;
            height: auto;
            border: 1px solid #dee2e6;
            padding: 5px;
            background-color: white;
        }

        .list-group-item-action {
            cursor: pointer;
        }
    </style>
</head>

<body>
    <div class="container-fluid my-4">
        <div class="row">
            <!-- Left Column: Navigation -->
            <div class="col-md-3">
                <div id="test-list-container">
                    <h3 class="d-flex align-items-center mb-3">
                        <img src="/glade/images/ginger.png" width="32" class="me-2">
                        GingerJS Tests
                    </h3>
                    <div class="list-group" id="test-list">
                        <div class="list-group-item">
                            <div class="spinner-border spinner-border-sm" role="status">
                                <span class="visually-hidden">Loading tests...</span>
                            </div>
                            <span class="ms-2">Loading tests...</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column: Main Content -->
            <div class="col-md-9">
                <div id="test-view-container">
                    <div id="welcome-message">
                        <div class="card">
                            <div class="card-body">
                                <h2 class="card-title">Welcome to the GingerJS Test Runner</h2>
                                <p class="card-text text-muted">This UI allows you to execute and review the results of
                                    the
                                    various test scripts for the GingerJS platform.</p>
                                <p class="card-text">Select a test from the list on the left to begin.</p>
                            </div>
                        </div>
                    </div>
                    <div id="test-view" class="d-none">
                        <h2 id="test-title"></h2>
                        <p id="test-description" class="text-muted"></p>
                        <hr>

                        <!-- Source Code View -->
                        <div id="source-code-view" class="mb-4">
                            <div class="d-flex justify-content-between align-items-center">
                                <h4>Server Script Source</h4>
                                <button class="btn btn-outline-secondary btn-sm" id="copy-source-btn"
                                    title="Copy to Clipboard">
                                    <i class="bi bi-clipboard"></i> <span id="copy-btn-text">Copy</span>
                                </button>
                            </div>
                            <div class="spinner-border spinner-border-sm mt-2" id="source-spinner" role="status"></div>
                            <pre
                                class="border rounded bg-light p-2 mt-2 d-none"><code id="source-code-content" class="language-javascript"></code></pre>
                        </div>

                        <!-- Input Area -->
                        <div id="input-area" class="mb-3">
                            <!-- Input form will be dynamically inserted here -->
                        </div>
                        <button id="run-test-btn" class="btn btn-primary">Run Test</button>
                        <hr>

                        <!-- Results Area -->
                        <h3>Result</h3>
                        <div id="results-spinner" class="spinner-border d-none" role="status"></div>
                        <div id="results-area" class="mt-2">
                            <!-- Results will be dynamically inserted here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

    <script src="/tests/scripts/cl_tester.js"></script>
</body>

</html>
